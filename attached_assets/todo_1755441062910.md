# Step-by-step Build Plan → Tasks, Subtasks, Dependencies

> Format: Markdown checklists with numeric IDs.
> Every task/subtask has context + dependencies.
> Tech baseline per PRD: Next.js (React, TS), Tailwind + shadcn/ui, Recharts/Chart.js, Vercel hosting.
> Data sources referenced in PRD: `marketing_plan.json`, `invest.json`, `n8nvsmake.json`, `показателимсб.json`, `эконом.json`.

---

## 100 — Project Initialization

* [ ] **(100)** Initialize Project & Governance
  *Create the foundation for code, issues, CI, and standards.*
  **Depends:** —

  * [ ] **(101)** Create repo and branch model
    *Create Git repo, default branch `main`, protect with required reviews; create `develop` branch for integration.*
    **Depends:** 100

  * [ ] **(102)** Add license, codeowners, issue/PR templates
    *`LICENSE` (e.g., MIT), `.github/CODEOWNERS`, `.github/ISSUE_TEMPLATE/*`, `.github/PULL_REQUEST_TEMPLATE.md`.*
    **Depends:** 101

  * [ ] **(103)** Set up Node toolchain
    *`node >= 20`, `pnpm` or `yarn`; add `.nvmrc`, `.editorconfig`.*
    **Depends:** 101

  * [ ] **(104)** Initialize Next.js + TS
    *`pnpm create next-app --ts`; enable `app/` router; strict mode; SWC minify.*
    **Depends:** 103

  * [ ] **(105)** Linting/Formatting & Git hooks
    *ESLint (Next/TS rules), Prettier, import/order, `husky` + `lint-staged` for pre-commit; add CI lint step.*
    **Depends:** 104

  * [ ] **(106)** Basic CI on PR
    *GitHub Actions: install cache, build, typecheck, lint. Fails block merge.*
    **Depends:** 105

---

## 200 — Design System & UI Foundations

* [ ] **(200)** Establish Design System
  *Typography, color system, spacing, components via shadcn/ui.*
  **Depends:** 100

  * [ ] **(201)** Install Tailwind & configure theme
    *`tailwind.config.js` (font scale, container, color tokens `primary/neutral/accent`), `globals.css` with CSS variables.*
    **Depends:** 200

  * [ ] **(202)** Add shadcn/ui + base components
    *Button, Card, Table, Tabs, Dialog, Tooltip, Input, Select. Configure alias `@/components`.*
    **Depends:** 201

  * [ ] **(203)** Icon system
    *`lucide-react` for icons; `Icon` wrapper with accessible labels.*
    **Depends:** 202

  * [ ] **(204)** KPI “MetricCard” component
    *Large number, label, optional tooltip and delta indicator; responsive grid behavior.*
    **Depends:** 202

  * [ ] **(205)** Page shell & layout
    *Header (logo, nav for 7 tabs), footer (contacts/CTA), container widths, dark-neutral premium palette.*
    **Depends:** 202

---

## 300 — Data & Content Pipeline

* [ ] **(300)** Data ingestion & typing
  *Normalize all JSON inputs into typed, versioned data modules.*
  **Depends:** 100

  * [ ] **(301)** Define TypeScript domain models
    *Interfaces for: MarketGrowth, MSPAdoption, ProductMatrixItem, FinancialMonth, MarketingMonth, RiskItem, InvestmentBreakdown.*
    **Depends:** 300

  * [ ] **(302)** Add runtime validation
    *`zod` schemas mirroring the interfaces; validate at build-time; fail build on schema mismatch.*
    **Depends:** 301

  * [ ] **(303)** Import `invest.json` → market modules
    *Map `market_analysis.growth_forecast` (2021–2030) + penetration to `MarketGrowth[]` & `MSPAdoption[]`.*
    **Depends:** 302

  * [ ] **(304)** Import `эконом.json` → financial modules
    *Map `financial_forecast_12_months` to `FinancialMonth[]`; map `assumptions.product_matrix` to `ProductMatrixItem[]`; map risks.*
    **Depends:** 302

  * [ ] **(305)** Import `marketing_plan.json` → marketing modules
    *Map `monthly_plan[]` to `MarketingMonth[]`; compute totals/averages for KPIs (CPL, CAC, ROMI, clients).*
    **Depends:** 302

  * [ ] **(306)** Import `n8nvsmake.json` & `показателимсб.json`
    *Normalize comparison rows and case metrics for “Проект/Преимущества” and optional references.*
    **Depends:** 302

  * [ ] **(307)** Content access layer
    *Create `@/lib/data` with getters (`getMarketGrowth()`, `getFinancials()`, etc.); export memoized, validated data.*
    **Depends:** 303, 304, 305, 306

  * [ ] **(308)** Unit tests for transforms
    *`vitest` tests: shape conformity, totals (e.g., sum of year revenue), sorted years, no NaN values.*
    **Depends:** 307

---

## 400 — Routing & Page Scaffolding

* [ ] **(400)** Page structure & navigation
  *Create routes & shells for all PRD tabs.*
  **Depends:** 200, 300

  * [ ] **(401)** Create routes
    *`/` (Главная), `/market`, `/project`, `/financials`, `/marketing`, `/risks`, `/invest` using Next `app` router.*
    **Depends:** 400

  * [ ] **(402)** Page headers & breadcrumbs
    *Consistent page titles, subtitles; breadcrumb optional for clarity; SEO title/description placeholders.*
    **Depends:** 401

  * [ ] **(403)** Shared sections
    *Intro section, content grid, standardized section headers with anchor links for deep-linking.*
    **Depends:** 401

---

## 500 — Data Visuals & Reusable Components

* [ ] **(500)** Visualization toolkit
  *Reusable charts and tables wired to domain models.*
  **Depends:** 200, 300

  * [ ] **(501)** Charting library & wrappers
    *Install Recharts; create `<LineChartX>`, `<BarChartX>`, `<PieChartX>` with A11y (titles, desc), tooltip, legend.*
    **Depends:** 500

  * [ ] **(502)** Table primitives
    *Sticky header, sortable columns, numeric alignment, export-to-CSV helper.*
    **Depends:** 500

  * [ ] **(503)** Financial table component
    *Columns: Month, Revenue, Expenses, Net Profit, Cumulative CashFlow; number formatting; negative in red.*
    **Depends:** 502, 300

  * [ ] **(504)** Product matrix table
    *Columns: Type, Name, Price; optional badges; grouping (Audit/Install/Package/Support).*
    **Depends:** 502, 300

  * [ ] **(505)** Risk matrix table
    *Columns: Risk, Threat, Mitigation; supports icon in first column.*
    **Depends:** 502, 300

  * [ ] **(506)** KPI deck component
    *Grid of `MetricCard` with consistent sizing; supports footnotes/tooltips to cite source.*
    **Depends:** 204

  * [ ] **(507)** Investment breakdown chart & table
    *Pie chart + table with totals; accepts percentages and absolute values; validates sum ≈ 100%.*
    **Depends:** 501, 502

---

## 600 — Page Implementations (Content + Visuals)

* [ ] **(600)** Build all pages to PRD spec
  *Fill with real data from `@/lib/data`, using reusable components.*
  **Depends:** 400, 500, 300

  * [ ] **(601)** Главная (Hero KPIs)
    *Show 5 metrics: Round size, Positive cash-flow month, Break-even month, 12m revenue, Clients/year; `MetricCard` grid; CTA.*
    **Depends:** 506, 307

  * [ ] **(602)** Рынок (Market)
    *Two charts: Market size (line) 2021–2030; MSP penetration (line); bullets with drivers; source footnotes.*
    **Depends:** 501, 303, 403

  * [ ] **(603)** Проект (Project)
    *Intro; Product matrix table from `эконом.json`; “Why us” bullets (n8n/Make comparison summary).*
    **Depends:** 504, 306, 403

  * [ ] **(604)** Финансовая модель (Financials)
    *12-month table; charts: Revenue vs Expenses (combo), Net Profit (bar), Cumulative CF (line); insights list (months 7 & 9).*
    **Depends:** 503, 501, 304, 403

  * [ ] **(605)** Маркетинг и продажи (Marketing)
    *Charts: Budget vs Leads (combo), Clients per month (bar), ROMI over time (line); summary table for the year.*
    **Depends:** 501, 502, 305, 403

  * [ ] **(606)** Риски (Risks)
    *Risk matrix table with 3–4 items and mitigations; optional icons.*
    **Depends:** 505, 304, 403

  * [ ] **(607)** Инвестиционное предложение (Invest)
    *Table of spend + Pie chart; headline with round and payback; CTA.*
    **Depends:** 507, 403

---

## 700 — Accessibility, UX Polish & Content QA

* [ ] **(700)** A11y & polish
  *Ensure site is accessible, consistent, and legible.*
  **Depends:** 600

  * [ ] **(701)** Keyboard & screen reader paths
    *Focus states, tab order, skip links, ARIA for charts/tables (titles/desc), semantic headings.*
    **Depends:** 600

  * [ ] **(702)** Color contrast & motion
    *WCAG AA contrast; prefers-reduced-motion for chart animations.*
    **Depends:** 201, 501

  * [ ] **(703)** Number formatting & locales
    *Ruble currency, thousands separators, negative red; shared `format.ts` utils.*
    **Depends:** 503, 605

  * [ ] **(704)** Content QA against sources
    *Cross-check key figures on pages with data modules; add footnotes where needed.*
    **Depends:** 601, 602, 603, 604, 605, 606, 607

---

## 800 — Testing

* [ ] **(800)** Testing Strategy
  *Unit, integration, E2E; add to CI.*
  **Depends:** 600

  * [ ] **(801)** Unit tests for utils & components
    *`vitest` + `@testing-library/react` for `MetricCard`, tables, formatters, chart wrappers (render without crash).*
    **Depends:** 500

  * [ ] **(802)** Integration tests for data → UI
    *Render Market/Financials pages with fixtures; assert chart/table datasets and totals.*
    **Depends:** 601, 602, 604, 605

  * [ ] **(803)** E2E tests (Playwright)
    *Happy paths: navigate all tabs, check KPIs visible, charts rendered, table rows count; mobile & desktop.*
    **Depends:** 802

  * [ ] **(804)** CI test jobs
    *Add unit/integration/E2E to CI matrix; cache deps; artifacts on failure (screenshots, videos).*
    **Depends:** 803, 106

---

## 900 — Performance & SEO

* [ ] **(900)** Perf & discoverability
  *Core Web Vitals, SSR/ISR, metadata.*
  **Depends:** 600

  * [ ] **(901)** Measure & optimize CWV
    *Lighthouse budgets; reduce bundle via dynamic import for charts; memoize heavy components; image/asset strategy.*
    **Depends:** 501, 205

  * [ ] **(902)** SEO/OG metadata
    *Per-page `<metadata>` in Next; titles, descriptions; Open Graph images; canonical URLs.*
    **Depends:** 402

  * [ ] **(903)** Sitemap & robots
    *`/sitemap.xml`, `/robots.txt`; disable crawling for preview envs.*
    **Depends:** 401

  * [ ] **(904)** ISR/Static generation config
    *Prefer static generation; revalidate strategy for data (if any future edits).*
    **Depends:** 401

---

## 1000 — Security & Compliance

* [ ] **(1000)** Basic security posture
  *Harden headers and automate dependency hygiene.*
  **Depends:** 600

  * [ ] **(1001)** Security headers & CSP
    *Next `headers()` with CSP (script-src ‘self’ vercel domains), `X-Content-Type-Options`, `Referrer-Policy`, `Permissions-Policy`.*
    **Depends:** 1000

  * [ ] **(1002)** Dependency scanning
    *Enable GitHub Dependabot & vulnerability alerts; weekly schedule.*
    **Depends:** 101

  * [ ] **(1003)** Secrets & config policy
    *No secrets in repo; `NEXT_PUBLIC_*` only for safe values; environment variable guidelines in README.*
    **Depends:** 101

---

## 1100 — Deployment

* [ ] **(1100)** Deploy to production
  *Vercel project + domain + protected previews.*
  **Depends:** 900, 1000

  * [ ] **(1101)** Vercel project & envs
    *Connect repo; preview/prod envs; set build command; env vars (if any).*
    **Depends:** 1100

  * [ ] **(1102)** Domain setup & HTTPS
    *Attach custom domain; DNS; enforce HTTPS; `www` → apex redirect.*
    **Depends:** 1101

  * [ ] **(1103)** Preview protection
    *Password-protect previews; limit to org members.*
    **Depends:** 1101

  * [ ] **(1104)** Production smoke test
    *Open each route; verify charts and tables render; console free of errors.*
    **Depends:** 1102, 1103

---

## 1200 — Analytics & Monitoring

* [ ] **(1200)** Observability
  *Usage analytics + error tracking + uptime.*
  **Depends:** 1100, 600

  * [ ] **(1201)** Web analytics
    *Plausible/Umami or GA4; track page views and CTA clicks; anonymize IP.*
    **Depends:** 1101

  * [ ] **(1202)** Error tracking (Sentry)
    *Client & server init; source maps upload on build; alert on new issues.*
    **Depends:** 1101

  * [ ] **(1203)** Uptime & status
    *UptimeRobot/BetterStack; alerts to email/Telegram.*
    **Depends:** 1104

---

## 1300 — Documentation & Handover

* [ ] **(1300)** Docs & maintenance
  *Ensure project is understandable and maintainable.*
  **Depends:** 1100

  * [ ] **(1301)** README for devs
    *Stack, scripts, env vars, how to add data, how to run tests, deploy.*
    **Depends:** 1300

  * [ ] **(1302)** Runbook / ops playbook
    *How to roll back, rotate keys, handle incidents, purge cache, debug charts.*
    **Depends:** 1104

  * [ ] **(1303)** Content update guide
    *Where JSON lives, schema versions, how to validate & re-generate derived metrics.*
    **Depends:** 307

  * [ ] **(1304)** CHANGELOG & release process
    *Keep a human-readable changelog; semantic versioning; release checklist.*
    **Depends:** 106

  * [ ] **(1305)** Backlog of improvements
    *Nice-to-haves: print/PDF export, data editor, drill-downs, compare scenarios.*
    **Depends:** 704

---

### Cross-cutting Implementation Notes

* **Data contracts:** all pages use `@/lib/data` accessors; no page directly imports raw JSON.
* **Number formatting:** one utility for currency/percentages; consistent rounding (no flicker across pages).
* **Charts:** prefer static generation with serialized data; avoid heavy dynamic libs on initial load; `dynamic()` import charts where needed.
* **A11y:** each chart gets `<title>`/`<desc>`; tables have captions; keyboard navigation tested.
* **Perf:** measure and keep main bundle lean; do not ship large locale libs; tree-shake Recharts.
* **QA:** each route has an E2E test; table row counts and column names asserted; key KPIs snapshot-verified.

---

## Dependency Overview (DAG Summary)

* **200** ← 100
* **300** ← 100
* **400** ← 200, 300
* **500** ← 200, 300
* **600** ← 400, 500, 300
* **700** ← 600
* **800** ← 600 (801 ← 500; 802 ← 601/602/604/605; 803 ← 802; 804 ← 803, 106)
* **900** ← 600
* **1000** ← 600 (1002/1003 may start after 101)
* **1100** ← 900, 1000 (1104 ← 1102, 1103)
* **1200** ← 1100, 600
* **1300** ← 1100 (1303 ← 307; 1304 ← 106)

All tasks are connected; the only root is **100**.
